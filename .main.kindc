App = {λS $(self: (App S)) ∀(P: ∀(x: (App S)) *) ∀(new: ∀(init: !3299013034441 S) ∀(tick: !3299029811674 ∀(x: !3299025617365 S) !3299030860250 S) ∀(when: !3299049734642 ∀(x: !3299043443176 U48) !3299054977522 ∀(x: !3299050783213 S) !3299056026098 S) (P ((((App/new S) init) tick) when))) (P self): ∀(S: !3298994160055 *) *};
App/new = {λS λD λinit λwhen λdebug !2199469949387 ~!2199470997963 λP !2199475192267 λnew !2199481483722 (((!2199482532281 new !2199486726590 init) !2199491969475 when) !2199497212361 debug): ∀(S: _0) ∀(D: _1) ∀(init: !2199402840427 S) ∀(when: !2199413326226 ∀(key: !2199422763392 U48) !2199428006290 ∀(state: !2199439540622 S) !2199442686353 S) ∀(debug: !2199454220700 D) !2199458415016 ((!2199459463587 App !2199463657893 S) !2199465755047 D)};
Board = {λA !16492691193883 (!16492692242453 List !16492697485338 Move): ∀(A: _2) !16492686999565 *};
Board/sort = {λboard !41781497430195 ((((!41781498478651 List/qsort !41781504770109 _3) !41781508964421 board) !41781517353086 λa !41781521547390 λb !41781525741691 ((!41781526790232 Cell/lt !41781535178857 (!41781536227430 Move/getCell !41781549858920 a)) !41781553004666 (!41781554053239 Move/getCell !41781567684729 b))) !41781573976242 λa !41781578170546 λb !41781582364850 ((!41781583413391 Cell/gte !41781592850592 (!41781593899165 Move/getCell !41781607530655 a)) !41781610676401 (!41781611724974 Move/getCell !41781625356464 b))): ∀(board: !41781473312807 (!41781474361380 Board !41781480652838 _4)) !41781485895731 (!41781486944304 Board !41781493235762 _5)};
Bool = {$(self: Bool) ∀(P: ∀(x: Bool) *) ∀(true: (P Bool/true)) ∀(false: (P Bool/false)) (P self): *};
Bool/and = {λa λb !61572983554401 use a.P = _6; use a.true = !61573002428752 b; use a.false = !61573013963103 Bool/false; ((((Bool/match a.P) a.true) a.false) a): ∀(a: !61572959437098 Bool) ∀(b: !61572969922868 Bool) !61572977262907 Bool};
Bool/false = {!45080096276609 ~!45080097325185 λP !45080101519489 λt !45080105713793 λf !45080109908096 f: !45080089985136 Bool};
Bool/if = {λP λb λt λf !50577972134337 use b.P = _7; use b.true = !50577991008692 t; use b.false = !50578002543039 f; ((((Bool/match b.P) b.true) b.false) b): ∀(P: !50577938579842 *) ∀(b: !50577946968461 Bool) ∀(t: !50577957454228 P) ∀(f: !50577964794267 P) !50577968988575 P};
Bool/match = {λP λt λf λb !48379008647652 (((!48379009696222 ~!48379010744797 b !48379012841951 P) !48379014939105 t) !48379017036259 f): ∀(P: !48378942587306 ∀(x: !48378949927334 Bool) !48378956218793 *) ∀(t: !48378963558839 (!48378964607409 P !48378966704566 Bool/true)) ∀(f: !48378978238918 (!48378979287487 P !48378981384645 Bool/false)) ∀(b: !48378993967568 Bool) !48379001307608 (!48379002356181 P !48379004453335 b)};
Bool/not = {λx !47279205515499 use x.P = _8; use x.true = !47279224389851 Bool/false; use x.false = !47279240118505 Bool/true; ((((Bool/match x.P) x.true) x.false) x): ∀(x: !47279191883963 Bool) !47279199224002 Bool};
Bool/true = {!46179501998108 ~!46179503046684 λP !46179507240988 λt !46179511435292 λf !46179515629595 t: !46179495706635 Bool};
Cell = {λA !21990248284189 ((!21990249332756 Pair !21990254575640 U48) !21990258769948 U48): ∀(A: _9) !21990244089868 *};
Cell/eq = {λa λb !60473241239816 use a.P = _10; use a.new = λa.fst λa.snd !60473263259910 use b.P = _11; use b.new = λb.fst λb.snd !60473294717189 let fstEq = !60473307300026 (!60473308348584 U48/to_bool !60473316737209 (== !60473320931506 a.fst !60473327222968 b.fst)); !60473341903109 let sndEq = !60473354485991 (!60473355534549 U48/to_bool !60473363923174 (== !60473368117471 a.snd !60473374408933 b.snd)); !60473389089023 ((!60473390137586 Bool/and !60473394331896 fstEq) !60473400623358 sndEq); (((((Pair/match _12) _13) b.P) b.new) b); (((((Pair/match _14) _15) a.P) a.new) a): ∀(a: !60473208733770 (!60473209782343 Cell !60473215025225 _16)) ∀(b: !60473223413848 (!60473224462421 Cell !60473229705303 _17)) !60473234948191 Bool};
Cell/gte = {λa λb !42881024786514 (!42881025835080 Bool/not !42881030029393 ((!42881031077964 Cell/lt !42881034223694 a) !42881036320848 b)): ∀(a: !42880992280621 (!42880993329194 Cell !42880998572076 _18)) ∀(b: !42881006960699 (!42881008009272 Cell !42881013252154 _19)) !42881018495042 Bool};
Cell/lt = {λa λb !49478129156406 use a.P = _20; use a.new = λa.fst λa.snd !49478151176500 use b.P = _21; use b.new = λb.fst λb.snd !49478180536627 let sndLt = !49478193119419 (!49478194167978 U48/to_bool !49478202556602 (< !49478205702323 a.snd !49478211993785 b.snd)); !49478221431085 ((((!49478222479552 Bool/if !49478225625282 _22) !49478227722440 sndLt) !49478234013901 Bool/true) !49478241354028 let fstLt = !49478253936885 (!49478254985444 U48/to_bool !49478263374068 (< !49478266519789 b.snd !49478272811251 a.snd)); !49478282248492 ((((!49478283297018 Bool/if !49478286442748 _23) !49478288539906 fstLt) !49478294831368 Bool/false) !49478310560043 (!49478311608602 U48/to_bool !49478319997226 (< !49478323142947 a.fst !49478329434409 b.fst)))); (((((Pair/match _24) _25) b.P) b.new) b); (((((Pair/match _26) _27) a.P) a.new) a): ∀(a: !49478096650318 (!49478097698891 Cell !49478102941773 _28)) ∀(b: !49478111330396 (!49478112378969 Cell !49478117621851 _29)) !49478122864739 Bool};
Char = {!71468267339790 U48: !71468263145480 *};
Direction = {$(self: Direction) ∀(P: ∀(x: Direction) *) ∀(left: (P Direction/left)) ∀(up: (P Direction/up)) ∀(right: (P Direction/right)) ∀(down: (P Direction/down)) (P self): *};
Direction/down = {!6597088641078 ~!6597089689654 λP !6597093883958 λleft !6597101223990 λup !6597106466870 λright !6597114855478 λdown !6597122195510 down: !6597077106704 Direction};
Direction/fromKeycode = {λkeycode !4398161854745 ((((!4398162903157 U48/if !4398170243191 _30) !4398172340359 (== !4398176534659 keycode !4398184923270 37)) !4398189117589 ((!4398190166157 Maybe/some !4398195409039 _31) !4398197506196 Direction/left)) !4398203797784 ((((!4398204846237 U48/if !4398212186271 _32) !4398214283439 (== !4398218477739 keycode !4398226866350 38)) !4398231060667 ((!4398232109237 Maybe/some !4398237352119 _33) !4398239449274 Direction/up)) !4398243643671 ((((!4398244692163 U48/if !4398252032197 _34) !4398254129365 (== !4398258323665 keycode !4398266712276 39)) !4398270906596 ((!4398271955163 Maybe/some !4398277198045 _35) !4398279295203 Direction/right)) !4398286635286 ((((!4398287683820 U48/if !4398295023854 _36) !4398297121022 (== !4398301315322 keycode !4398309703933 40)) !4398313898252 ((!4398314946820 Maybe/some !4398320189702 _37) !4398322286859 Direction/down)) !4398328578325 (!4398329626898 Maybe/none !4398334869780 _38))))): ∀(keycode: !4398135640152 U48) !4398141931628 (!4398142980193 Maybe !4398149271659 Direction)};
Direction/left = {!7696600268854 ~!7696601317430 λP !7696605511734 λleft !7696612851766 λup !7696618094646 λright !7696626483254 λdown !7696633823286 left: !7696588734480 Direction};
Direction/match = {λP λleft λup λright λdown λdirection !35184551395532 (((((!35184552444087 ~!35184553492662 direction !35184563978424 P) !35184566075581 left) !35184571318464 up) !35184574464198 right) !35184580755659 down): ∀(P: !35184437100609 ∀(x: !35184424517691 Direction) !35184438149184 *) ∀(left: !35184448634961 (!35184449683531 P !35184451780688 Direction/left)) ∀(up: !35184464363614 (!35184465412186 P !35184467509341 Direction/up)) ∀(right: !35184481140849 (!35184482189418 P !35184484286576 Direction/right)) ∀(down: !35184500015234 (!35184501063804 P !35184503160961 Direction/down)) ∀(direction: !35184523083929 Direction) !35184535666857 (!35184536715422 P !35184538812584 direction)};
Direction/right = {!8796112945208 ~!8796113993784 λP !8796118188088 λleft !8796125528120 λup !8796130771000 λright !8796139159608 λdown !8796146499640 right: !8796101410833 Direction};
Direction/up = {!9895621427250 ~!9895622475826 λP !9895626670130 λleft !9895634010162 λup !9895639253042 λright !9895647641650 λdown !9895654981682 up: !9895609892878 Direction};
GameState = {$(self: GameState) ∀(P: ∀(x: GameState) *) ∀(inProgress: ∀(currentPlayer: !29686860087346 Player) ∀(cursorPosition: !29686886301773 (!29686887350346 Cell !29686892593228 _39)) ∀(board: !29686905176160 (!29686906224733 Board !29686912516191 _40)) (P (((GameState/inProgress currentPlayer) cursorPosition) board))) ∀(draw: ∀(board: !29686932439162 (!29686933487735 Board !29686939779193 _41)) (P (GameState/draw board))) ∀(winner: ∀(player: !29686962847892 Player) ∀(board: !29686979625127 (!29686980673700 Board !29686986965158 _42)) (P ((GameState/winner player) board))) (P self): *};
GameState/cellAvailable = {λstate !59373763166630 use state.P = _43; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !59373796721033 let occupiedCells = !59373817692390 ((((!59373818740926 List/map !59373828178115 Move) !59373833421004 (!59373834469577 Cell !59373839712459 _44)) !59373842858200 state.board) !59373855441125 Move/getCell); !59373874315657 let cellOccupied = !59373894238532 (((!59373895287048 List/find !59373905772810 _45) !59373907870006 λcell !59373915210037 ((!59373916258586 Cell/eq !59373924647199 cell) !59373929890100 state.cursorPosition)) !59373952958787 occupiedCells); !59373972881798 use cellOccupied.P = _46; use cellOccupied.some = λcellOccupied.value !59374007484783 Bool/false; use cellOccupied.none = !59374026359168 Bool/true; (((((Maybe/match _47) cellOccupied.P) cellOccupied.some) cellOccupied.none) cellOccupied); use state.draw = λstate.board !59374046282132 Bool/false; use state.winner = λstate.player λstate.board !59374063059364 Bool/false; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state): ∀(state: !59373744291960 GameState) !59373756874879 Bool};
GameState/draw = {λboard !30786364375124 ~!30786365423700 λP !30786369618004 λinProgress !30786383249492 λdraw !30786390589524 λwinner !30786400026707 (!30786401075276 draw !30786406318162 board): ∀(board: !30786340257815 (!30786341306388 Board !30786347597846 _48)) !30786352840739 GameState};
GameState/inProgress = {λcurrentPlayer λcursorPosition λboard !15393261355184 ~!15393262403760 λP !15393266598064 λinProgress !15393280229552 λdraw !15393287569584 λwinner !15393297006767 (((!15393298055307 inProgress !15393309589657 currentPlayer) !15393324269736 cursorPosition) !15393339998382 board): ∀(currentPlayer: !15393192149026 Player) ∀(cursorPosition: !15393218363453 (!15393219412026 Cell !15393224654908 _49)) ∀(board: !15393237237840 (!15393238286413 Board !15393244577871 _50)) !15393249820764 GameState};
GameState/match = {λP λinProgress λdraw λwinner λgameState !32985732612499 ((((!32985733661050 ~!32985734709625 gameState !32985745195387 P) !32985747292550 inProgress) !32985758826891 draw) !32985764069778 winner): ∀(P: !32985372950554 ∀(x: !32985360367636 GameState) !32985373999129 *) ∀(inProgress: !32985390776501 ∀(currentPlayer: !32985410699329 Player) !32985419088053 ∀(cursorPosition: !32985440059487 (!32985441108060 Cell !32985446350942 _51)) !32985450545333 ∀(board: !32985462079605 (!32985463128178 Board !32985469419636 _52)) !32985473614004 (!32985474662521 P !32985476759731 (((!32985477808271 GameState/inProgress !32985499828381 currentPlayer) !32985514508460 cursorPosition) !32985530237106 board))) ∀(draw: !32985547014382 ∀(board: !32985558548689 (!32985559597262 Board !32985565888720 _53)) !32985570083053 (!32985571131605 P !32985573228780 (!32985574277349 GameState/draw !32985590005995 board))) ∀(winner: !32985608880454 ∀(player: !32985621463306 Player) !32985629851974 ∀(board: !32985641386272 (!32985642434845 Board !32985648726303 _54)) !32985652920645 (!32985653969188 P !32985656066372 ((!32985657114934 GameState/winner !32985674940733 player) !32985682280771 board))) ∀(gameState: !32985704300892 GameState) !32985716883820 (!32985717932385 P !32985720029547 gameState)};
GameState/moveCursor = {λstate λdirection !34085013553829 use forward = !34085028233394 λn !34085032427697 (% !34085035573422 (+ !34085038719147 n !34085040816301 1) !34085043962032 3); !34085047108261 use backward = !34085062836490 λn !34085069127946 let neg1 = !34085080662233 (- !34085083807958 0 !34085085905112 1); !34085091148042 let n = !34085099536619 (- !34085102682344 n !34085104779498 1); !34085110022408 ((((!34085111070965 U48/if !34085118410999 _55) !34085120508163 (== !34085124702461 n !34085126799618 neg1)) !34085133091077 2) !34085135188231 n); !34085139382949 use state.P = _56; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !34085172937352 use position = !34085188665930 use direction.P = _57; use direction.left = !34085221171593 (((((!34085222220132 Pair/mapFst !34085234803046 _58) !34085236900200 _59) !34085238997354 _60) !34085241094527 state.cursorPosition) !34085263114632 backward); use direction.up = !34085287231944 (((((!34085288280483 Pair/mapSnd !34085300863397 _61) !34085302960551 _62) !34085305057705 _63) !34085307154878 state.cursorPosition) !34085329174983 backward); use direction.right = !34085353292294 (((((!34085354340834 Pair/mapFst !34085366923748 _64) !34085369020902 _65) !34085371118056 _66) !34085373215229 state.cursorPosition) !34085395235333 forward); use direction.down = !34085418304068 (((((!34085419352608 Pair/mapSnd !34085431935522 _67) !34085434032676 _68) !34085436129830 _69) !34085438227003 state.cursorPosition) !34085460247107 forward); ((((((Direction/match direction.P) direction.left) direction.up) direction.right) direction.down) direction); !34085481218693 (((!34085482267227 GameState/inProgress !34085493801583 state.currentPlayer) !34085514773112 position) !34085524210308 state.board); use state.draw = λstate.board !34085546230419 state; use state.winner = λstate.player λstate.board !34085563007651 state; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state): ∀(state: !34084965318765 GameState) ∀(direction: !34084989436036 Direction) !34085002018960 GameState};
GameState/new = {λA !39582919819846 let cursorInitialPosition = !39582949179916 ((((!39582950228483 Pair/new !39582959665669 _70) !39582961762823 _71) !39582963859977 0) !39582965957131 0); !39582969102917 (((!39582970151458 GameState/inProgress !39582992171563 Player/x) !39583001608769 cursorInitialPosition) !39583024677444 (List/nil _72)): ∀(A: _73) !39582908285404 GameState};
GameState/putMove = {λstate !40682056057383 use state.P = _74; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !40682089611786 let cellAvailable = !40682110582977 (!40682111631546 GameState/cellAvailable !40682126311616 state); !40682137846279 use cellAvailable.P = _75; use cellAvailable.true = !40682201809414 let player = !40682215440691 (!40682216489246 Player/switch !40682231169330 state.currentPlayer); !40682261578246 let move = !40682273112442 ((!40682274160976 Move/new !40682283598180 state.currentPlayer) !40682304569721 state.cursorPosition); !40682328687110 let board = !40682341269930 (((!40682342318484 List/concat !40682354901398 _76) !40682356998562 state.board) !40682369581481 (((List/cons _77) !40682370630056 move) (List/nil _78))); !40682379018758 let board = !40682391601610 (!40682392650179 Board/sort !40682404184521 board); !40682419913217 (((!40682420961758 GameState/inProgress !40682432496101 player) !40682439836154 state.cursorPosition) !40682461856256 board); use cellAvailable.false = !40682174546158 state; ((((Bool/match cellAvailable.P) cellAvailable.true) cellAvailable.false) cellAvailable); use state.draw = λstate.board !40682483876373 state; use state.winner = λstate.player λstate.board !40682500653605 state; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state): ∀(state: !40682031939690 GameState) !40682044522614 GameState};
GameState/winner = {λplayer λboard !31885895925872 ~!31885896974448 λP !31885901168752 λinProgress !31885914800240 λdraw !31885922140272 λwinner !31885931577455 ((!31885932626017 winner !31885939966056 player) !31885947306094 board): ∀(player: !31885855031319 Player) ∀(board: !31885871808554 (!31885872857127 Board !31885879148585 _79)) !31885884391478 GameState};
List = {λT $(self: (List T)) ∀(P: ∀(x: (List T)) *) ∀(cons: ∀(head: !17592215404573 T) ∀(tail: !17592225890350 (!17592226938923 List !17592232181805 T)) (P (((List/cons T) head) tail))) ∀(nil: (P (List/nil T))) (P self): ∀(T: _80) *};
List/concat = {λT λxs λys !53876498629213 use xs.P = _81; use xs.cons = λxs.head λxs.tail !53876607681063 (((!53876608729606 List/cons !53876613972488 _82) !53876616069648 xs.head) !53876624458278 (((!53876625506840 List/concat !53876632846874 _83) !53876634944034 xs.tail) !53876643332645 ys)); use xs.nil = !53876699955803 ys; (((((List/match _84) xs.P) xs.cons) xs.nil) xs): ∀(T: _85) ∀(xs: !53876460880253 (!53876461928826 List !53876467171708 T)) ∀(ys: !53876476608908 (!53876477657481 List !53876482900363 T)) !53876488143255 (!53876489191828 List !53876494434710 T)};
List/cons = {λT λhead λtail !18691748003923 ~!18691749052499 λP !18691753246803 λcons !18691760586835 λnil !18691766878290 ((!18691767926855 cons !18691773169740 head) !18691778412625 tail): ∀(T: _86) ∀(head: !18691715498002 T) ∀(tail: !18691725983779 (!18691727032352 List !18691732275234 T)) !18691737518126 (!18691738566699 List !18691743809581 T)};
List/filter = {λA λcond λlist !56075198923073 use list.P = _87; use list.cons = λlist.head λlist.tail !56075225137455 let test = !56075236671641 (!56075237720206 cond !56075242963096 list.head); !56075258691887 let head = !56075270226168 use test.P = λtest !56075338383608 ∀(x: !56075326849255 (!56075327897828 List !56075333140710 A)) !56075339432179 (!56075340480752 List !56075345723634 A); use test.true = !56075290149070 ((!56075291197633 List/cons !56075296440515 _88) !56075298537677 list.head); use test.false = !56075317412060 λx !56075321606363 x; ((((Bool/match test.P) test.true) test.false) test); !56075353063727 let tail = !56075364598044 (((!56075365646602 List/filter !56075372986636 _89) !56075375083793 cond) !56075380326683 list.tail); !56075396055340 (!56075397103910 head !56075402346795 tail); use list.nil = !56075420172607 (!56075421221180 List/nil !56075425415486 _90); (((((List/match _91) list.P) list.cons) list.nil) list): ∀(A: _92) ∀(cond: !56075162222664 ∀(x: !56075158028351 A) !56075163271239 Bool) ∀(list: !56075176902744 (!56075177951317 List !56075183194199 A)) !56075188437091 (!56075189485664 List !56075194728546 A)};
List/find = {λA λfn λxs !62672286515472 use xs.P = _93; use xs.cons = λxs.head λxs.tail !62672311681281 let result = !62672325312679 (!62672326361246 fn !62672329506982 xs.head); !62672343138558 use result.P = _94; use result.true = !62672371450071 ((!62672372498636 Maybe/some !62672377741518 _95) !62672379838678 xs.head); use result.false = !62672402907384 (((!62672403955946 List/find !62672409198828 _96) !62672411295983 fn) !62672414441719 xs.tail); ((((Bool/match result.P) result.true) result.false) result); use xs.nil = !62672437510414 (!62672438558987 Maybe/none !62672443801869 _97); (((((List/match _98) xs.P) xs.cons) xs.nil) xs): ∀(A: _99) ∀(fn: !62672250863706 ∀(x: !62672246669393 A) !62672251912281 Bool) ∀(xs: !62672263446632 (!62672264495205 List !62672269738087 A)) !62672274980980 (!62672276029553 Maybe !62672282321011 A)};
List/map = {λA λB λxs λfn !63772197651062 use xs.P = _100; use xs.cons = λxs.head λxs.tail !63772221768292 let head = !63772233302561 (!63772234351128 fn !63772237496864 xs.head); !63772251128420 let tail = !63772262662730 ((((!63772263711290 List/map !63772273148476 _101) !63772275245630 _102) !63772277342790 xs.tail) !63772285731401 fn); !63772294120033 (((!63772295168596 List/cons !63772300411478 _103) !63772302508635 head) !63772307751520 tail); use xs.nil = !63772325577332 (!63772326625905 List/nil !63772330820211 _104); (((((List/match _105) xs.P) xs.cons) xs.nil) xs): ∀(A: _106) ∀(B: _107) ∀(xs: !63772161999321 (!63772163047894 List !63772168290776 A)) ∀(fn: !63772181922279 ∀(x: !63772177727969 A) !63772182970854 B) !63772187165169 (!63772188213742 List !63772193456624 B)};
List/match = {λA λP λc λn λxs !54975730286745 (((!54975731335315 ~!54975732383890 xs !54975735529620 P) !54975737626774 c) !54975739723928 n): ∀(A: _108) ∀(P: !54975608651805 ∀(x: !54975597117463 (!54975598166036 List !54975603408918 A)) !54975609700380 *) ∀(c: !54975617040479 ∀(head: !54975627526189 A) !54975630671967 ∀(tail: !54975641157697 (!54975642206270 List !54975647449152 A)) !54975651643486 (!54975652692037 P !54975654789213 (((!54975655837776 List/cons !54975666323538 A) !54975668420695 head) !54975673663580 tail))) ∀(n: !54975686246516 (!54975687295078 P !54975689392243 (!54975690440816 List/nil !54975699878002 A))) ∀(xs: !54975710363779 (!54975711412352 List !54975716655234 A)) !54975721898124 (!54975722946696 P !54975725043851 xs)};
List/nil = {λT !19791230271530 ~!19791231320106 λP !19791235514410 λcons !19791242854442 λnil !19791249145897 nil: ∀(T: _109) !19791219785746 (!19791220834319 List !19791226077201 T)};
List/qsort = {λA λlist λlt λgte !52776675574113 use list.P = _110; use list.cons = λlist.head λlist.tail !52776717517152 let lesser = !52776732197066 (((!52776733245613 List/filter !52776740585647 _111) !52776742682815 (!52776743731380 gte !52776747925694 list.head)) !52776759460041 list.tail); !52776775188832 let greater = !52776789868801 (((!52776790917348 List/filter !52776798257382 _112) !52776800354550 (!52776801403114 lt !52776805597429 list.head)) !52776817131776 list.tail); !52776832860511 (((!52776833909010 List/concat !52776846491924 _113) !52776854880562 ((((!52776855929121 List/qsort !52776862220579 _114) !52776864317738 lesser) !52776871657773 lt) !52776874803505 gte)) !52776898920798 (((List/cons _115) !52776886337858 list.head) !52776899969374 ((((!52776901017932 List/qsort !52776907309390 _116) !52776909406550 greater) !52776917795161 lt) !52776920940893 gte))); use list.nil = !52776696545419 (!52776697593992 List/nil !52776701788298 _117); (((((List/match _118) list.P) list.cons) list.nil) list): ∀(A: _119) ∀(list: !52776608464952 (!52776609513525 List !52776614756407 A)) ∀(lt: !52776628387918 ∀(x: !52776624193600 A) !52776633630798 ∀(x: !52776629436485 A) !52776634679373 Bool) ∀(gte: !52776651456612 ∀(x: !52776647262294 A) !52776656699492 ∀(x: !52776652505179 A) !52776657748067 Bool) !52776665088110 (!52776666136683 List !52776671379565 A)};
Maybe = {λT $(self: (Maybe T)) ∀(P: ∀(x: (Maybe T)) *) ∀(some: ∀(value: !10995150880802 T) (P ((Maybe/some T) value))) ∀(none: (P (Maybe/none T))) (P self): ∀(T: !10995132006416 *) *};
Maybe/match = {λA λP λs λn λma !64871316062343 (((!64871317110913 ~!64871318159488 ma !64871321305218 P) !64871323402372 s) !64871325499526 n): ∀(A: _120) ∀(P: !64871214350366 ∀(x: !64871201767448 (!64871202816021 Maybe !64871209107479 A)) !64871215398941 *) ∀(s: !64871222739018 ∀(value: !64871234273327 A) !64871237419081 (!64871238467635 P !64871240564808 ((!64871241613375 Maybe/some !64871253147713 A) !64871255244871 value))) ∀(n: !64871268876385 (!64871269924945 P !64871272022112 (!64871273070685 Maybe/none !64871284605023 A))) ∀(ma: !64871295090801 (!64871296139374 Maybe !64871302430832 A)) !64871307673722 (!64871308722294 P !64871310819449 ma)};
Maybe/none = {λT !12094650974254 ~!12094652022830 λP !12094656217134 λsome !12094663557166 λnone !12094670897197 none: ∀(T: _121) !12094639439892 (!12094640488465 Maybe !12094646779923 T)};
Maybe/some = {λT λvalue !13194174136385 ~!13194175184961 λP !13194179379265 λsome !13194186719297 λnone !13194194059328 (!13194195107897 some !13194200350783 value): ∀(T: _122) ∀(value: !13194158407699 T) !13194162602015 (!13194163650588 Maybe !13194169942046 T)};
Move = {$(self: Move) ∀(P: ∀(x: Move) *) ∀(new: ∀(player: !20890747142175 Player) ∀(cell: !20890762870832 (!20890763919405 Cell !20890769162287 _123)) (P ((Move/new player) cell))) (P self): *};
Move/getCell = {λmove !57174653927506 use move.P = _124; use move.new = λmove.player λmove.cell !57174679093328 move.cell; (((Move/match move.P) move.new) move): ∀(move: !57174636101666 Move) !57174643441709 (!57174644490282 Cell !57174649733164 _125)};
Move/match = {λP λnew λmove !58274242101381 ((!58274243149951 ~!58274244198526 move !58274249441408 P) !58274251538564 new): ∀(P: !58274135146517 ∀(x: !58274127806479 Move) !58274136195092 *) ∀(new: !58274145632351 ∀(player: !58274158215214 Player) !58274166603871 ∀(cell: !58274177089602 (!58274178138175 Cell !58274183381057 _126)) !58274187575390 (!58274188623942 P !58274190721117 ((!58274191769680 Move/new !58274201206871 player) !58274208546908 cell))) ∀(move: !58274224275563 Move) !58274231615606 (!58274232664176 P !58274234761333 move)};
Move/new = {λplayer λcell !25288821964880 ~!25288823013456 λP !25288827207760 λnew !25288833499216 ((!25288834547779 new !25288838742090 player) !25288846082127 cell): ∀(player: !25288782118932 Player) ∀(cell: !25288797847595 ((!25288798896162 Pair !25288804139046 U48) !25288808333354 U48)) !25288815673394 Move};
Nat = {$(self: Nat) ∀(P: ∀(x: Nat) *) ∀(succ: ∀(pred: !74766814806042 Nat) (P (Nat/succ pred))) ∀(zero: (P Nat/zero)) (P self): *};
Nat/succ = {λn !75866324336689 ~!75866325385265 λP !75866329579569 λsucc !75866336919601 λzero !75866344259632 (!75866345308205 succ !75866350551087 n): ∀(n: !75866312802317 Nat) !75866319093779 Nat};
Nat/zero = {!76965826527268 ~!76965827575844 λP !76965831770148 λsucc !76965839110180 λzero !76965846450211 zero: !76965821284362 Nat};
Pair = {λA λB $(self: ((Pair A) B)) ∀(P: ∀(x: ((Pair A) B)) *) ∀(new: ∀(fst: !23089781932069 A) ∀(snd: !23089791369262 B) (P ((((Pair/new A) B) fst) snd))) (P self): ∀(A: !23089758863375 *) ∀(B: !23089766203414 *) *};
Pair/mapFst = {λA λB λT λp λf !36283964457081 use p.P = _127; use p.new = λp.fst λp.snd !36283982282871 ((((!36283983331426 Pair/new !36283987525732 T) !36283989622886 B) !36283991720048 (!36283992768617 f !36283994865775 p.fst)) !36284002205814 p.snd); (((((Pair/match _128) _129) p.P) p.new) p): ∀(A: _130) ∀(B: _131) ∀(T: _132) ∀(p: !36283925659698 ((!36283926708269 Pair !36283931951151 A) !36283934048305 B)) ∀(f: !36283946631231 ∀(x: !36283942436921 A) !36283947679806 T) !36283951874123 ((!36283952922694 Pair !36283958165576 T) !36283960262730 B)};
Pair/mapSnd = {λA λB λT λp λf !38482987712633 use p.P = _133; use p.new = λp.fst λp.snd !38483005538423 ((((!38483006586978 Pair/new !38483010781284 A) !38483012878438 T) !38483014975596 p.fst) !38483021267062 (!38483022315631 f !38483024412789 p.snd)); (((((Pair/match _134) _135) p.P) p.new) p): ∀(A: _136) ∀(B: _137) ∀(T: _138) ∀(p: !38482948915250 ((!38482949963821 Pair !38482955206703 A) !38482957303857 B)) ∀(f: !38482969886783 ∀(x: !38482965692473 B) !38482970935358 T) !38482975129675 ((!38482976178246 Pair !38482981421128 A) !38482983518282 T)};
Pair/match = {λA λB λP λnew λpair !37383525367945 ((!37383526416515 ~!37383527465090 pair !37383532707972 P) !37383534805128 new): ∀(A: _139) ∀(B: _140) ∀(P: !37383428898851 ∀(x: !37383415267357 ((!37383416315928 Pair !37383421558810 A) !37383423655964 B)) !37383429947426 *) ∀(new: !37383439384669 ∀(fst: !37383448821812 A) !37383451967581 ∀(snd: !37383461404736 B) !37383464550492 (!37383465599044 P !37383467696219 ((((!37383468744782 Pair/new !37383478181968 A) !37383480279122 B) !37383482376278 fst) !37383486570586 snd))) ∀(pair: !37383501250671 ((!37383502299242 Pair !37383507542124 A) !37383509639278 B)) !37383514882170 (!37383515930740 P !37383518027897 pair)};
Pair/new = {λA λB λa λb !24189297754173 ~!24189298802749 λP !24189302997053 λnew !24189309288508 ((!24189310337079 new !24189314531385 a) !24189316628539 b): ∀(A: _141) ∀(B: _142) ∀(a: !24189273636882 A) ∀(b: !24189280976921 B) !24189285171238 ((!24189286219809 Pair !24189291462691 A) !24189293559845 B)};
Player = {$(self: Player) ∀(P: ∀(x: Player) *) ∀(x: (P Player/x)) ∀(o: (P Player/o)) (P self): *};
Player/match = {λP λx λo λp !67070297374814 (((!67070298423384 ~!67070299471959 p !67070301569113 P) !67070303666267 x) !67070305763421 o): ∀(P: !67070230265879 ∀(x: !67070220828689 Player) !67070231314454 *) ∀(x: !67070238654506 (!67070239703070 P !67070241800233 !67070242848808 Player/X)) ∀(o: !67070259626046 (!67070260674610 P !67070262771773 !67070263820348 Player/O)) ∀(p: !67070280597578 Player) !67070290034770 (!67070291083343 P !67070293180497 p)};
Player/o = {!27487803277338 ~!27487804325914 λP !27487808520218 λx !27487812714522 λo !27487816908826 o: !27487794888714 Player};
Player/switch = {λplayer !65970753241171 use player.P = _143; use player.x = !65970774212682 Player/o; use player.o = !65970781552721 Player/x; ((((Player/match player.P) player.x) player.o) player): ∀(player: !65970735415338 Player) !65970744852531 Player};
Player/x = {!28587314905114 ~!28587315953690 λP !28587320147994 λx !28587324342298 λo !28587328536602 x: !28587306516490 Player};
String = {!70368759906330 (!70368760954900 List !70368766197785 Char): !70368753614858 *};
String/cons = {λhead λtail !72567819862101 ~!72567820910677 λP !72567825104981 λcons !72567832445013 λnil !72567838736468 ((!72567839785033 cons !72567845027918 head) !72567850270803 tail): ∀(head: !72567788404760 Char) ∀(tail: !72567802036263 String) !72567811473456 String};
String/nil = {!73667301081131 ~!73667302129707 λP !73667306324011 λcons !73667313664043 λnil !73667319955498 nil: !73667292692499 String};
U48/if = {λP λx λt λf !14294062203302 switch x = x { 0: !14294078980505 f _: use x-1 = x-1; !14294086320544 t }: !14294091563429 P: ∀(P: _144) ∀(x: !14294038086004 U48) ∀(t: !14294047523195 P) ∀(f: !14294054863234 P) !14294059057542 P};
U48/to_bool = {λx !51677096837208 switch x = x { 0: !51677113614405 Bool/false _: use x-1 = x-1; !51677125148751 Bool/true }: !51677133537367 Bool: ∀(x: !51677084254247 U48) !51677090545710 Bool};
main = {!1099521065688 use init = !1099532599333 (!1099533647906 GameState/new !1099548327972 _145); !1099552522968 use when = !1099564057277 λkey !1099570348733 λstate !1099580834491 use state.P = _146; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !1099658429057 ((((!1099659477139 U48/if !1099666817173 _147) !1099668914337 (== !1099673108637 key !1099677302944 13)) !1099689885891 (!1099690934460 GameState/putMove !1099709808834 state)) !1099749655168 ((((!1099750703338 U48/if !1099758043372 _148) !1099760140536 (== !1099764334836 key !1099768529143 88)) !1099781112129 (((!1099782160662 GameState/inProgress !1099804180767 Player/x) !1099813617972 state.cursorPosition) !1099835638080 state.board)) !1099881775743 ((((!1099882824040 U48/if !1099890164074 _149) !1099892261238 (== !1099896455538 key !1099900649845 79)) !1099913232831 (((!1099914281364 GameState/inProgress !1099936301469 Player/o) !1099945738674 state.cursorPosition) !1099967758782 state.board)) !1100005507710 let direction = !1100022284802 (!1100023333373 Direction/fromKeycode !1100046402049 key); !1100060033662 use direction.P = _150; use direction.some = λdirection.value !1100101976671 ((!1100103025224 GameState/moveCursor !1100125045326 state) !1100131336798 direction.value); use direction.none = !1100164891252 state; (((((Maybe/match _151) direction.P) direction.some) direction.none) direction)))); use state.draw = λstate.board !1100205785755 state; use state.winner = λstate.player λstate.board !1100235145911 state; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state); !1100246680279 (((((!1100247728837 App/new !1100256117447 _152) !1100258214601 _153) !1100260311758 init) !1100265554643 when) !1100270797526 (List/nil _154)): !1099517919239 _155};
o = {!68169733505050 ~!68169734553626 λP !68169738747930 λx !68169742942234 λo !68169747136538 o: !68169725116426 Player};
x = {!69269245132826 ~!69269246181402 λP !69269250375706 λx !69269254570010 λo !69269258764314 x: !69269236744202 Player};
MAIN = main;
