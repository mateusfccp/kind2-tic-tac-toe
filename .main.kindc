Char = {!30786337112078 U48: !30786332917768 *};
Direction = {$(self: Direction) ∀(P: ∀(x: Direction) *) ∀(left: (P Direction/left)) ∀(up: (P Direction/up)) ∀(right: (P Direction/right)) ∀(down: (P Direction/down)) (P self): *};
Direction/down = {!3298553757750 ~!3298554806326 λP !3298559000630 λleft !3298566340662 λup !3298571583542 λright !3298579972150 λdown !3298587312182 down: !3298542223376 Direction};
Direction/left = {!4398065385526 ~!4398066434102 λP !4398070628406 λleft !4398077968438 λup !4398083211318 λright !4398091599926 λdown !4398098939958 left: !4398053851152 Direction};
Direction/match = {λP λleft λup λright λdown λdirection !7696760701132 (((((!7696761749687 ~!7696762798262 direction !7696773284024 P) !7696775381181 left) !7696780624064 up) !7696783769798 right) !7696790061259 down): ∀(P: !7696646406209 ∀(x: !7696633823291 Direction) !7696647454784 *) ∀(left: !7696657940561 (!7696658989131 P !7696661086288 Direction/left)) ∀(up: !7696673669214 (!7696674717786 P !7696676814941 Direction/up)) ∀(right: !7696690446449 (!7696691495018 P !7696693592176 Direction/right)) ∀(down: !7696709320834 (!7696710369404 P !7696712466561 Direction/down)) ∀(direction: !7696732389529 Direction) !7696744972457 (!7696746021022 P !7696748118184 direction)};
Direction/right = {!5497578061880 ~!5497579110456 λP !5497583304760 λleft !5497590644792 λup !5497595887672 λright !5497604276280 λdown !5497611616312 right: !5497566527505 Direction};
Direction/up = {!6597086543922 ~!6597087592498 λP !6597091786802 λleft !6597099126834 λup !6597104369714 λright !6597112758322 λdown !6597120098354 up: !6597075009550 Direction};
GameState = {$(self: GameState) ∀(P: ∀(x: GameState) *) ∀(inProgress: ∀(currentPlayer: !8796139159602 Player) ∀(cursorPosition: !8796165374035 ((!8796166422602 Pair !8796171665486 U48) !8796175859794 U48)) ∀(board: !8796190539880 (!8796191588450 List !8796196831335 Move)) (P (((GameState/inProgress currentPlayer) cursorPosition) board))) ∀(draw: ∀(board: !8796219900036 (!8796220948606 List !8796226191491 Move)) (P (GameState/draw board))) ∀(winner: ∀(player: !8796252405918 Player) ∀(board: !8796269183155 (!8796270231725 List !8796275474610 Move)) (P ((GameState/winner player) board))) (P self): *};
GameState/draw = {λboard !9895645544533 ~!9895646593109 λP !9895650787413 λinProgress !9895664418901 λdraw !9895671758933 λwinner !9895681196117 (!9895682244686 draw !9895687487572 board): ∀(board: !9895619330073 (!9895620378643 List !9895625621528 Move)) !9895634010149 GameState};
GameState/inProgress = {λcurrentPlayer λcursorPosition λboard !21990339510455 ~!21990340559031 λP !21990344753335 λinProgress !21990358384823 λdraw !21990365724855 λwinner !21990375162039 (((!21990376210579 inProgress !21990387744929 currentPlayer) !21990402425008 cursorPosition) !21990418153654 board): ∀(currentPlayer: !21990261915682 Player) ∀(cursorPosition: !21990288130115 ((!21990289178682 Pair !21990294421566 U48) !21990298615874 U48)) ∀(board: !21990313295960 (!21990314344530 List !21990319587415 Move)) !21990327976036 GameState};
GameState/match = {λP λinProgress λdraw λwinner λgameState !24189652173215 ((((!24189653221766 ~!24189654270341 gameState !24189664756103 P) !24189666853266 inProgress) !24189678387607 draw) !24189683630494 winner): ∀(P: !24189279928346 ∀(x: !24189267345428 GameState) !24189280976921 *) ∀(inProgress: !24189297754301 ∀(currentPlayer: !24189317677121 Player) !24189326065853 ∀(cursorPosition: !24189347037285 ((!24189348085852 Pair !24189353328736 U48) !24189357523044 U48)) !24189363814589 ∀(board: !24189375348861 (!24189376397431 List !24189381640316 Move)) !24189388980412 (!24189390028929 P !24189392126139 (((!24189393174679 GameState/inProgress !24189415194789 currentPlayer) !24189429874868 cursorPosition) !24189445603514 board))) ∀(draw: !24189462380792 ∀(board: !24189473915099 (!24189474963669 List !24189480206554 Move)) !24189487546615 (!24189488595167 P !24189490692342 (!24189491740911 GameState/draw !24189507469557 board))) ∀(winner: !24189526344018 ∀(player: !24189538926868 Player) !24189547315538 ∀(board: !24189558849836 (!24189559898406 List !24189565141291 Move)) !24189572481361 (!24189573529904 P !24189575627088 ((!24189576675650 GameState/winner !24189594501449 player) !24189601841487 board))) ∀(gameState: !24189623861608 GameState) !24189636444536 (!24189637493101 P !24189639590263 gameState)};
GameState/moveCursor = {λstate λdirection !1099664720576 use forward = !1099679400114 λn !1099683594417 (% !1099686740142 (+ !1099689885867 n !1099691983021 1) !1099695128752 3); !1099698275008 use backward = !1099714003210 λn !1099720294666 let neg1 = !1099731828953 (- !1099734974678 0 !1099737071832 1); !1099742314762 let n = !1099750703339 (- !1099753849064 n !1099755946218 1); !1099761189128 ((((!1099762237685 U48/if !1099769577719 _0) !1099771674883 (== !1099775869181 n !1099777966338 neg1)) !1099784257797 2) !1099786354951 n); !1099790549696 use state.P = _1; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !1099824104099 use position = !1099839832677 use direction.P = _2; use direction.left = !1099879678352 (((((!1099880726891 Pair/mapFst !1099893309805 _3) !1099895406959 _4) !1099897504113 _5) !1099899601286 state.cursorPosition) !1099921621391 backward); use direction.up = !1099950981588 (((((!1099952030127 Pair/mapSnd !1099964613041 _6) !1099966710195 _7) !1099968807349 _8) !1099970904522 state.cursorPosition) !1099992924627 backward); use direction.right = !1100025430554 (((((!1100026479094 Pair/mapFst !1100039062008 _9) !1100041159162 _10) !1100043256316 _11) !1100045353489 state.cursorPosition) !1100067373593 forward); use direction.down = !1100097782367 (((((!1100098830907 Pair/mapSnd !1100111413821 _12) !1100113510975 _13) !1100115608129 _14) !1100117705302 state.cursorPosition) !1100139725406 forward); ((((((Direction/match direction.P) direction.left) direction.up) direction.right) direction.down) direction); !1100160696992 (((!1100161745526 GameState/inProgress !1100173279882 state.currentPlayer) !1100194251411 position) !1100203688607 state.board); use state.draw = λstate.board !1100225708718 state; use state.winner = λstate.player λstate.board !1100242485950 state; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state): ∀(state: !1099616485485 GameState) ∀(direction: !1099640602756 Direction) !1099653185680 GameState};
GameState/winner = {λplayer λboard !23089805000817 ~!23089806049393 λP !23089810243697 λinProgress !23089823875185 λdraw !23089831215217 λwinner !23089840652401 ((!23089841700963 winner !23089849041002 player) !23089856381040 board): ∀(player: !23089762009111 Player) ∀(board: !23089778786348 (!23089779834918 List !23089785077803 Move)) !23089793466424 GameState};
List = {λT $(self: (List T)) ∀(P: ∀(x: (List T)) *) ∀(cons: ∀(head: !10995145637917 T) ∀(tail: !10995156123694 (!10995157172267 List !10995162415149 T)) (P (((List/cons T) head) tail))) ∀(nil: (P (List/nil T))) (P self): ∀(T: _15) *};
List/cons = {λT λhead λtail !12094678237267 ~!12094679285843 λP !12094683480147 λcons !12094690820179 λnil !12094697111634 ((!12094698160199 cons !12094703403084 head) !12094708645969 tail): ∀(T: _16) ∀(head: !12094645731346 T) ∀(tail: !12094656217123 (!12094657265696 List !12094662508578 T)) !12094667751470 (!12094668800043 List !12094674042925 T)};
List/nil = {λT !13194160504874 ~!13194161553450 λP !13194165747754 λcons !13194173087786 λnil !13194179379241 nil: ∀(T: _17) !13194150019090 (!13194151067663 List !13194156310545 T)};
Move = {$(self: Move) ∀(P: ∀(x: Move) *) ∀(new: ∀(player: !14293677375519 Player) ∀(cell: !14293693104182 ((!14293694152749 Pair !14293699395633 U48) !14293703589941 U48)) (P ((Move/new player) cell))) (P self): *};
Move/new = {λplayer λcell !15393217314896 ~!15393218363472 λP !15393222557776 λnew !15393228849232 ((!15393229897795 new !15393234092106 player) !15393241432143 cell): ∀(player: !15393177468948 Player) ∀(cell: !15393193197611 ((!15393194246178 Pair !15393199489062 U48) !15393203683370 U48)) !15393211023410 Move};
Nat = {$(self: Nat) ∀(P: ∀(x: Nat) *) ∀(succ: ∀(pred: !34084884578330 Nat) (P (Nat/succ pred))) ∀(zero: (P Nat/zero)) (P self): *};
Nat/succ = {λn !35184394108977 ~!35184395157553 λP !35184399351857 λsucc !35184406691889 λzero !35184414031920 (!35184415080493 succ !35184420323375 n): ∀(n: !35184382574605 Nat) !35184388866067 Nat};
Nat/zero = {!36283896299556 ~!36283897348132 λP !36283901542436 λsucc !36283908882468 λzero !36283916222499 zero: !36283891056650 Nat};
Pair = {λA λB $(self: ((Pair A) B)) ∀(P: ∀(x: ((Pair A) B)) *) ∀(new: ∀(fst: !16492712165413 A) ∀(snd: !16492721602606 B) (P ((((Pair/new A) B) fst) snd))) (P self): ∀(A: !16492689096719 *) ∀(B: !16492696436758 *) *};
Pair/mapFst = {λA λB λT λp λf !25288848179321 use p.P = _18; use p.new = λp.fst λp.snd !25288866005111 ((((!25288867053666 Pair/new !25288871247972 T) !25288873345126 B) !25288875442288 (!25288876490857 f !25288878588015 p.fst)) !25288885928054 p.snd); (((((Pair/match _19) _20) p.P) p.new) p): ∀(A: _21) ∀(B: _22) ∀(T: _23) ∀(p: !25288809381938 ((!25288810430509 Pair !25288815673391 A) !25288817770545 B)) ∀(f: !25288830353471 ∀(x: !25288826159161 A) !25288831402046 T) !25288835596363 ((!25288836644934 Pair !25288841887816 T) !25288843984970 B)};
Pair/mapSnd = {λA λB λT λp λf !27487871434873 use p.P = _24; use p.new = λp.fst λp.snd !27487889260663 ((((!27487890309218 Pair/new !27487894503524 A) !27487896600678 T) !27487898697836 p.fst) !27487904989302 (!27487906037871 f !27487908135029 p.snd)); (((((Pair/match _25) _26) p.P) p.new) p): ∀(A: _27) ∀(B: _28) ∀(T: _29) ∀(p: !27487832637490 ((!27487833686061 Pair !27487838928943 A) !27487841026097 B)) ∀(f: !27487853609023 ∀(x: !27487849414713 B) !27487854657598 T) !27487858851915 ((!27487859900486 Pair !27487865143368 A) !27487867240522 T)};
Pair/match = {λA λB λP λnew λpair !26388409090185 ((!26388410138755 ~!26388411187330 pair !26388416430212 P) !26388418527368 new): ∀(A: _30) ∀(B: _31) ∀(P: !26388312621091 ∀(x: !26388298989597 ((!26388300038168 Pair !26388305281050 A) !26388307378204 B)) !26388313669666 *) ∀(new: !26388323106909 ∀(fst: !26388332544052 A) !26388335689821 ∀(snd: !26388345126976 B) !26388348272732 (!26388349321284 P !26388351418459 ((((!26388352467022 Pair/new !26388361904208 A) !26388364001362 B) !26388366098518 fst) !26388370292826 snd))) ∀(pair: !26388384972911 ((!26388386021482 Pair !26388391264364 A) !26388393361518 B)) !26388398604410 (!26388399652980 P !26388401750137 pair)};
Pair/new = {λA λB λa λb !17592227987517 ~!17592229036093 λP !17592233230397 λnew !17592239521852 ((!17592240570423 new !17592244764729 a) !17592246861883 b): ∀(A: _32) ∀(B: _33) ∀(a: !17592203870226 A) ∀(b: !17592211210265 B) !17592215404582 ((!17592216453153 Pair !17592221696035 A) !17592223793189 B)};
Player = {$(self: Player) ∀(P: ∀(x: Player) *) ∀(x: (P Player/x)) ∀(o: (P Player/o)) (P self): *};
Player/o = {!19791221882906 ~!19791222931482 λP !19791227125786 λx !19791231320090 λo !19791235514394 o: !19791213494282 Player};
Player/x = {!20890733510682 ~!20890734559258 λP !20890738753562 λx !20890742947866 λo !20890747142170 x: !20890725122058 Player};
String = {!29686829678618 (!29686830727188 List !29686835970073 Char): !29686823387146 *};
String/cons = {λhead λtail !31885889634389 ~!31885890682965 λP !31885894877269 λcons !31885902217301 λnil !31885908508756 ((!31885909557321 cons !31885914800206 head) !31885920043091 tail): ∀(head: !31885858177048 Char) ∀(tail: !31885871808551 String) !31885881245744 String};
String/nil = {!32985370853419 ~!32985371901995 λP !32985376096299 λcons !32985383436331 λnil !32985389727786 nil: !32985362464787 String};
U48/if = {λP λx λt λf !28587713364390 switch x = x { 0: !28587730141593 f _: use x-1 = x-1; !28587737481632 t }: !28587742724517 P: ∀(P: _34) ∀(x: !28587689247092 U48) ∀(t: !28587698684283 P) ∀(f: !28587706024322 P) !28587710218630 P};
MAIN = GameState/moveCursor;
