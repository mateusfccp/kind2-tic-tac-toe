Board = {λA !2199577952796 (!2199579001366 List !2199584244251 Move): ∀(A: _0) !2199573758478 *};
Board/check = {λmove λcount λboard λdirection !15393410253518 use move.P = _1; use move.new = λmove.player λmove.cell !15393440662220 use move.cell.P = _2; use move.cell.new = λmove.cell.fst λmove.cell.snd !15393484702411 let targetCell = !15393502527842 ((!15393503576397 Cell/add !15393513013591 move.cell) !15393523499361 direction); !15393543422667 let target = !15393557053849 ((!15393558102401 Move/new !15393567539597 move.player) !15393580122520 targetCell); !15393601094347 let next = !15393612628433 (((!15393613676983 List/find !15393624162745 _3) !15393626259914 (!15393627308482 Move/eq !15393635697097 target)) !15393644085712 board); !15393660863176 use next.P = _4; use next.some = λnext.value !15393702806184 let nextCount = !15393719583262 (- !15393722728987 count !15393729020445 1); !15393737409181 switch nextCount = nextCount { 0: !15393775157841 Bool/true _: use nextCount-1 = nextCount-1; !15393803469455 ((((!15393804517993 Board/check !15393810809460 next.value) !15393822343806 nextCount) !15393832829572 board) !15393839121038 direction) }: _5; use next.none = !15393888404158 Bool/false; (((((Maybe/match _6) next.P) next.some) next.none) next); (((((Pair/match _7) _8) move.cell.P) move.cell.new) move.cell); (((Move/match move.P) move.new) move): ∀(move: !15393339998381 Move) ∀(count: !15393354678458 U48) ∀(board: !15393368309965 (!15393369358538 Board !15393375649996 _9)) ∀(direction: !15393392427235 (!15393393475808 Cell !15393398718690 _10)) !15393403961578 Bool};
Board/winner = {λboard !1099720295269 (((((!1099721343185 List/fold !1099731828950 Move) !1099737071845 (!1099738120413 Maybe !1099744411876 Player)) !1099754898249 λmove !1099762238281 λcurrent !1099772724037 use current.P = _11; use current.some = λcurrent.value !1099806277920 current; use current.none = !1099952030532 use c = !1099960418870 λdirection !1099973001782 λcurrent !1099983487528 use current.P = _12; use current.true = !1100020187630 Bool/true; use current.false = !1100044304928 ((((!1100045353480 Board/check !1100057936397 move) !1100063179279 2) !1100065276437 board) !1100071567903 direction); ((((Bool/match current.P) current.true) current.false) current); !1100105122628 let winner = !1100118753926 (((((!1100119802445 List/fold !1100130288207 _13) !1100132385361 _14) !1100134482515 c) !1100136579678 Bool/false) !1100148114053 (((List/cons _15) !1100149162597 right) (((List/cons _16) !1100156502635 down) (((List/cons _17) !1100162794104 bottomRight) (((List/cons _18) !1100176425604 bottomLeft) (List/nil _19)))))); !1100254020417 use winner.P = _20; use winner.true = !1100289671965 use move.P = _21; use move.new = λmove.player λmove.cell !1100316934938 ((!1100317983499 Maybe/some !1100329517837 _22) !1100331615001 move.player); (((Move/match move.P) move.new) move); use winner.false = !1100362023737 (!1100363072310 Maybe/none !1100374606648 _23); ((((Bool/match winner.P) winner.true) winner.false) winner); (((((Maybe/match _24) current.P) current.some) current.none) current)) !1100393481052 (!1100394529620 Maybe/none !1100406063963 Player)) !1100416549732 board): ∀(board: !1099690934452 (!1099691983025 Board !1099698274483 _25)) !1099703517381 (!1099704565949 Maybe !1099710857412 Player)};
Bool = {$(self: Bool) ∀(P: ∀(x: Bool) *) ∀(true: (P Bool/true)) ∀(false: (P Bool/false)) (P self): *};
Bool/and = {λa λb !30786657976673 use a.P = _26; use a.true = !30786676851024 b; use a.false = !30786688385375 Bool/false; ((((Bool/match a.P) a.true) a.false) a): ∀(a: !30786633859370 Bool) ∀(b: !30786644345140 Bool) !30786651685179 Bool};
Bool/false = {!17592305582209 ~!17592306630785 λP !17592310825089 λt !17592315019393 λf !17592319213696 f: !17592299290736 Bool};
Bool/match = {λP λt λf λb !23090241208804 (((!23090242257374 ~!23090243305949 b !23090245403103 P) !23090247500257 t) !23090249597411 f): ∀(P: !23090175148458 ∀(x: !23090182488486 Bool) !23090188779945 *) ∀(t: !23090196119991 (!23090197168561 P !23090199265718 Bool/true)) ∀(f: !23090210800070 (!23090211848639 P !23090213945797 Bool/false)) ∀(b: !23090226528720 Bool) !23090233868760 (!23090234917333 P !23090237014487 b)};
Bool/or = {λa λb !36284157395240 use a.P = _27; use a.true = !36284176269595 Bool/true; use a.false = !36284190949670 b; ((((Bool/match a.P) a.true) a.false) a): ∀(a: !36284133277938 Bool) ∀(b: !36284143763708 Bool) !36284151103747 Bool};
Bool/true = {!18691711303708 ~!18691712352284 λP !18691716546588 λt !18691720740892 λf !18691724935195 t: !18691705012235 Bool};
Cell = {λA !7697135043102 ((!7697136091669 Pair !7697141334553 U48) !7697145528861 U48): ∀(A: _28) !7697130848781 *};
Cell/add = {λa λb !19791257534642 use a.P = _29; use a.new = λa.fst λa.snd !19791284797616 use b.P = _30; use b.new = λb.fst λb.snd !19791320449196 ((((!19791321497715 Pair/new !19791330934901 _31) !19791333032055 _32) !19791345614993 (+ !19791348760714 a.fst !19791355052176 b.fst)) !19791372877995 (+ !19791376023716 a.snd !19791382315178 b.snd)); (((((Pair/match _33) _34) b.P) b.new) b); (((((Pair/match _35) _36) a.P) a.new) a): ∀(a: !19791219785746 (!19791220834319 Cell !19791226077201 _37)) ∀(b: !19791235514401 (!19791236562974 Cell !19791241805856 _38)) !19791247048748 (!19791248097321 Cell !19791253340203 _39)};
Cell/eq = {λa λb !31885938917640 use a.P = _40; use a.new = λa.fst λa.snd !31885960937734 use b.P = _41; use b.new = λb.fst λb.snd !31885992395013 let fstEq = !31886004977850 (!31886006026408 U48/to_bool !31886014415033 (== !31886018609330 a.fst !31886024900792 b.fst)); !31886039580933 let sndEq = !31886052163815 (!31886053212373 U48/to_bool !31886061600998 (== !31886065795295 a.snd !31886072086757 b.snd)); !31886086766847 ((!31886087815410 Bool/and !31886092009720 fstEq) !31886098301182 sndEq); (((((Pair/match _42) _43) b.P) b.new) b); (((((Pair/match _44) _45) a.P) a.new) a): ∀(a: !31885906411594 (!31885907460167 Cell !31885912703049 _46)) ∀(b: !31885921091672 (!31885922140245 Cell !31885927383127 _47)) !31885932626015 Bool};
Char = {!46179499900942 U48: !46179495706632 *};
List = {λT $(self: (List T)) ∀(P: ∀(x: (List T)) *) ∀(cons: ∀(head: !3298564243485 T) ∀(tail: !3298574729262 (!3298575777835 List !3298581020717 T)) (P (((List/cons T) head) tail))) ∀(nil: (P (List/nil T))) (P self): ∀(T: _48) *};
List/cons = {λT λhead λtail !4398096842835 ~!4398097891411 λP !4398102085715 λcons !4398109425747 λnil !4398115717202 ((!4398116765767 cons !4398122008652 head) !4398127251537 tail): ∀(T: _49) ∀(head: !4398064336914 T) ∀(tail: !4398074822691 (!4398075871264 List !4398081114146 T)) !4398086357038 (!4398087405611 List !4398092648493 T)};
List/find = {λA λfn λxs !21990356287760 use xs.P = _50; use xs.cons = λxs.head λxs.tail !21990381453569 let result = !21990395084967 (!21990396133534 fn !21990399279270 xs.head); !21990412910846 use result.P = _51; use result.true = !21990441222359 ((!21990442270924 Maybe/some !21990447513806 _52) !21990449610966 xs.head); use result.false = !21990472679672 (((!21990473728234 List/find !21990478971116 _53) !21990481068271 fn) !21990484214007 xs.tail); ((((Bool/match result.P) result.true) result.false) result); use xs.nil = !21990507282702 (!21990508331275 Maybe/none !21990513574157 _54); (((((List/match _55) xs.P) xs.cons) xs.nil) xs): ∀(A: _56) ∀(fn: !21990320635994 ∀(x: !21990316441681 A) !21990321684569 Bool) ∀(xs: !21990333218920 (!21990334267493 List !21990339510375 A)) !21990344753268 (!21990345801841 Maybe !21990352093299 A)};
List/fold = {λA λP λc λn λxs !43980555288731 use xs.P = _57; use xs.cons = λxs.head λxs.tail !43980575211664 ((!43980576260203 c !43980578357363 xs.head) !43980586745999 (((((!43980587794558 List/fold !43980598280320 _58) !43980600377474 P) !43980602474628 c) !43980604571782 n) !43980606668942 xs.tail)); use xs.nil = !43980624494745 n; (((((List/match _59) xs.P) xs.cons) xs.nil) xs): ∀(A: _60) ∀(P: !43980506005544 *) ∀(c: !43980518588475 ∀(x: !43980514394160 A) !43980523831355 ∀(x: !43980519637045 P) !43980524879930 P) ∀(n: !43980532219969 P) ∀(xs: !43980540608592 (!43980541657165 List !43980546900047 A)) !43980552142932 P};
List/match = {λA λP λc λn λxs !24189404709017 (((!24189405757587 ~!24189406806162 xs !24189409951892 P) !24189412049046 c) !24189414146200 n): ∀(A: _61) ∀(P: !24189283074077 ∀(x: !24189271539735 (!24189272588308 List !24189277831190 A)) !24189284122652 *) ∀(c: !24189291462751 ∀(head: !24189301948461 A) !24189305094239 ∀(tail: !24189315579969 (!24189316628542 List !24189321871424 A)) !24189326065758 (!24189327114309 P !24189329211485 (((!24189330260048 List/cons !24189340745810 A) !24189342842967 head) !24189348085852 tail))) ∀(n: !24189360668788 (!24189361717350 P !24189363814515 (!24189364863088 List/nil !24189374300274 A))) ∀(xs: !24189384786051 (!24189385834624 List !24189391077506 A)) !24189396320396 (!24189397368968 P !24189399466123 xs)};
List/nil = {λT !5497579110442 ~!5497580159018 λP !5497584353322 λcons !5497591693354 λnil !5497597984809 nil: ∀(T: _62) !5497568624658 (!5497569673231 List !5497574916113 T)};
Maybe = {λT $(self: (Maybe T)) ∀(P: ∀(x: (Maybe T)) *) ∀(some: ∀(value: !25288802041890 T) (P ((Maybe/some T) value))) ∀(none: (P (Maybe/none T))) (P self): ∀(T: !25288783167504 *) *};
Maybe/match = {λA λP λs λn λma !28587432345735 (((!28587433394305 ~!28587434442880 ma !28587437588610 P) !28587439685764 s) !28587441782918 n): ∀(A: _63) ∀(P: !28587330633758 ∀(x: !28587318050840 (!28587319099413 Maybe !28587325390871 A)) !28587331682333 *) ∀(s: !28587339022410 ∀(value: !28587350556719 A) !28587353702473 (!28587354751027 P !28587356848200 ((!28587357896767 Maybe/some !28587369431105 A) !28587371528263 value))) ∀(n: !28587385159777 (!28587386208337 P !28587388305504 (!28587389354077 Maybe/none !28587400888415 A))) ∀(ma: !28587411374193 (!28587412422766 Maybe !28587418714224 A)) !28587423957114 (!28587425005686 P !28587427102841 ma)};
Maybe/none = {λT !26388302135342 ~!26388303183918 λP !26388307378222 λsome !26388314718254 λnone !26388322058285 none: ∀(T: _64) !26388290600980 (!26388291649553 Maybe !26388297941011 T)};
Maybe/some = {λT λvalue !27487825297473 ~!27487826346049 λP !27487830540353 λsome !27487837880385 λnone !27487845220416 (!27487846268985 some !27487851511871 value): ∀(T: _65) ∀(value: !27487809568787 T) !27487813763103 (!27487814811676 Maybe !27487821103134 T)};
Move = {$(self: Move) ∀(P: ∀(x: Move) *) ∀(new: ∀(player: !6597095981087 Player) ∀(cell: !6597111709744 (!6597112758317 Cell !6597118001199 _66)) (P ((Move/new player) cell))) (P self): *};
Move/eq = {λa λb !29686846455970 use a.P = _67; use a.new = λa.player λa.cell !29686869524640 use b.P = _68; use b.new = λb.player λb.cell !29686900981916 ((!29686902030428 Bool/and !29686919856258 ((!29686920904815 Player/eq !29686931390584 a.player) !29686940827777 b.player)) !29686952362139 ((!29686953410700 Cell/eq !29686961799315 a.cell) !29686969139354 b.cell)); (((Move/match b.P) b.new) b); (((Move/match a.P) a.new) a): ∀(a: !29686822338572 Move) ∀(b: !29686832824342 Move) !29686840164381 Bool};
Move/match = {λP λnew λmove !34084986290309 ((!34084987338879 ~!34084988387454 move !34084993630336 P) !34084995727492 new): ∀(P: !34084879335445 ∀(x: !34084871995407 Move) !34084880384020 *) ∀(new: !34084889821279 ∀(player: !34084902404142 Player) !34084910792799 ∀(cell: !34084921278530 (!34084922327103 Cell !34084927569985 _69)) !34084931764318 (!34084932812870 P !34084934910045 ((!34084935958608 Move/new !34084945395799 player) !34084952735836 cell))) ∀(move: !34084968464491 Move) !34084975804534 (!34084976853104 P !34084978950261 move)};
Move/new = {λplayer λcell !10995170803792 ~!10995171852368 λP !10995176046672 λnew !10995182338128 ((!10995183386691 new !10995187581002 player) !10995194921039 cell): ∀(player: !10995130957844 Player) ∀(cell: !10995146686507 ((!10995147735074 Pair !10995152977958 U48) !10995157172266 U48)) !10995164512306 Move};
Nat = {$(self: Nat) ∀(P: ∀(x: Nat) *) ∀(succ: ∀(pred: !49478047367194 Nat) (P (Nat/succ pred))) ∀(zero: (P Nat/zero)) (P self): *};
Nat/succ = {λn !50577556897841 ~!50577557946417 λP !50577562140721 λsucc !50577569480753 λzero !50577576820784 (!50577577869357 succ !50577583112239 n): ∀(n: !50577545363469 Nat) !50577551654931 Nat};
Nat/zero = {!51677059088420 ~!51677060136996 λP !51677064331300 λsucc !51677071671332 λzero !51677079011363 zero: !51677053845514 Nat};
Pair = {λA λB $(self: ((Pair A) B)) ∀(P: ∀(x: ((Pair A) B)) *) ∀(new: ∀(fst: !8796130770981 A) ∀(snd: !8796140208174 B) (P ((((Pair/new A) B) fst) snd))) (P self): ∀(A: !8796107702287 *) ∀(B: !8796115042326 *) *};
Pair/match = {λA λB λP λnew λpair !20890850951305 ((!20890851999875 ~!20890853048450 pair !20890858291332 P) !20890860388488 new): ∀(A: _70) ∀(B: _71) ∀(P: !20890754482211 ∀(x: !20890740850717 ((!20890741899288 Pair !20890747142170 A) !20890749239324 B)) !20890755530786 *) ∀(new: !20890764968029 ∀(fst: !20890774405172 A) !20890777550941 ∀(snd: !20890786988096 B) !20890790133852 (!20890791182404 P !20890793279579 ((((!20890794328142 Pair/new !20890803765328 A) !20890805862482 B) !20890807959638 fst) !20890812153946 snd))) ∀(pair: !20890826834031 ((!20890827882602 Pair !20890833125484 A) !20890835222638 B)) !20890840465530 (!20890841514100 P !20890843611257 pair)};
Pair/new = {λA λB λa λb !9895646593085 ~!9895647641661 λP !9895651835965 λnew !9895658127420 ((!9895659175991 new !9895663370297 a) !9895665467451 b): ∀(A: _72) ∀(B: _73) ∀(a: !9895622475794 A) ∀(b: !9895629815833 B) !9895634010150 ((!9895635058721 Pair !9895640301603 A) !9895642398757 B)};
Player = {$(self: Player) ∀(P: ∀(x: Player) *) ∀(x: (P Player/x)) ∀(o: (P Player/o)) (P self): *};
Player/eq = {λa λb !35184454926471 ((!35184455974994 Bool/or !35184459120746 ((!35184460169303 Bool/and !35184464363616 (!35184465412189 Player/is_x !35184470655071 a)) !35184473800809 (!35184474849382 Player/is_x !35184480092264 b))) !35184488480902 ((!35184489529459 Bool/and !35184493723772 (!35184494772345 Player/is_o !35184500015227 a)) !35184503160965 (!35184504209538 Player/is_o !35184509452420 b))): ∀(a: !35184426614842 Player) ∀(b: !35184439197766 Player) !35184448634957 Bool};
Player/is_o = {λplayer !37383470841965 use player.P = _74; use player.x = !37383491813473 Bool/false; use player.o = !37383503347819 Bool/true; ((((Player/match player.P) player.x) player.o) player): ∀(player: !37383455113279 Player) !37383464550470 Bool};
Player/is_x = {λplayer !41781517353069 use player.P = _75; use player.x = !41781538324576 Bool/true; use player.o = !41781548810347 Bool/false; ((((Player/match player.P) player.x) player.o) player): ∀(player: !41781501624383 Player) !41781511061574 Bool};
Player/match = {λP λx λo λp !38482995052638 (((!38482996101208 ~!38482997149783 p !38482999246937 P) !38483001344091 x) !38483003441245 o): ∀(P: !38482927943703 ∀(x: !38482918506513 Player) !38482928992278 *) ∀(x: !38482936332330 (!38482937380894 P !38482939478057 !38482940526632 Player/X)) ∀(o: !38482957303870 (!38482958352434 P !38482960449597 !38482961498172 Player/O)) ∀(p: !38482978275402 Player) !38482987712594 (!38482988761167 P !38482990858321 p)};
Player/o = {!13194152116250 ~!13194153164826 λP !13194157359130 λx !13194161553434 λo !13194165747738 o: !13194143727626 Player};
Player/x = {!14293663744026 ~!14293664792602 λP !14293668986906 λx !14293673181210 λo !14293677375514 x: !14293655355402 Player};
String = {!45079992467482 (!45079993516052 List !45079998758937 Char): !45079986176010 *};
String/cons = {λhead λtail !47279052423253 ~!47279053471829 λP !47279057666133 λcons !47279065006165 λnil !47279071297620 ((!47279072346185 cons !47279077589070 head) !47279082831955 tail): ∀(head: !47279020965912 Char) ∀(tail: !47279034597415 String) !47279044034608 String};
String/nil = {!48378533642283 ~!48378534690859 λP !48378538885163 λcons !48378546225195 λnil !48378552516650 nil: !48378525253651 String};
U48/neg = {λn !42880975503388 (- !42880978649113 0 !42880980746267 n): ∀(n: !42880961871883 U48) !42880969211922 U48};
U48/to_bool = {λx !32985399165016 switch x = x { 0: !32985415942213 Bool/false _: use x-1 = x-1; !32985427476559 Bool/true }: !32985435865175 Bool: ∀(x: !32985386582055 U48) !32985392873518 Bool};
bottomLeft = {!15393293861017 ((((!15393294909574 Pair/new !15393304346760 _76) !15393306443914 _77) !15393308541078 (!15393309589651 U48/neg !15393317978261 1)) !15393321123992 1): !15393289666682 _78};
bottomRight = {!15393256112235 ((((!15393257160802 Pair/new !15393266597988 _79) !15393268695142 _80) !15393270792296 1) !15393272889450 1): !15393251917910 _81};
down = {!15393218363463 ((((!15393219412030 Pair/new !15393228849216 _82) !15393230946370 _83) !15393233043524 0) !15393235140678 1): !15393214169138 _84};
o = {!39582431182874 ~!39582432231450 λP !39582436425754 λx !39582440620058 λo !39582444814362 o: !39582422794250 Player};
right = {!15393180614691 ((((!15393181663258 Pair/new !15393191100444 _85) !15393193197598 _86) !15393195294752 1) !15393197391906 0): !15393176420366 _87};
x = {!40681942810650 ~!40681943859226 λP !40681948053530 λx !40681952247834 λo !40681956442138 x: !40681934422026 Player};
MAIN = Board/winner;
