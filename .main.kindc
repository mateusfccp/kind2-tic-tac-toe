App = {λS $(self: (App S)) ∀(P: ∀(x: (App S)) *) ∀(new: ∀(init: !3299013034441 S) ∀(tick: !3299029811674 ∀(x: !3299025617365 S) !3299030860250 S) ∀(when: !3299049734642 ∀(x: !3299043443176 U48) !3299054977522 ∀(x: !3299050783213 S) !3299056026098 S) (P ((((App/new S) init) tick) when))) (P self): ∀(S: !3298994160055 *) *};
App/new = {λS λinit λtick λwhen !2199477289425 ~!2199478338001 λP !2199482532305 λnew !2199488823760 (((!2199489872320 new !2199494066629 init) !2199499309514 tick) !2199504552399 when): ∀(S: _0) ∀(init: !2199398646119 S) ∀(tick: !2199409131904 ∀(state: !2199420666236 S) !2199423811967 S) ∀(when: !2199434297766 ∀(key: !2199443734932 U48) !2199448977830 ∀(state: !2199460512162 S) !2199463657893 S) !2199467852207 (!2199468900780 App !2199473095086 S)};
Char = {!39582430134286 U48: !39582425939976 *};
Direction = {$(self: Direction) ∀(P: ∀(x: Direction) *) ∀(left: (P Direction/left)) ∀(up: (P Direction/up)) ∀(right: (P Direction/right)) ∀(down: (P Direction/down)) (P self): *};
Direction/down = {!6597088641078 ~!6597089689654 λP !6597093883958 λleft !6597101223990 λup !6597106466870 λright !6597114855478 λdown !6597122195510 down: !6597077106704 Direction};
Direction/fromKeycode = {λkeycode !4398161854745 ((((!4398162903157 U48/if !4398170243191 _1) !4398172340359 (== !4398176534659 keycode !4398184923270 37)) !4398189117589 ((!4398190166157 Maybe/some !4398195409039 _2) !4398197506196 Direction/left)) !4398203797784 ((((!4398204846237 U48/if !4398212186271 _3) !4398214283439 (== !4398218477739 keycode !4398226866350 38)) !4398231060667 ((!4398232109237 Maybe/some !4398237352119 _4) !4398239449274 Direction/up)) !4398243643671 ((((!4398244692163 U48/if !4398252032197 _5) !4398254129365 (== !4398258323665 keycode !4398266712276 39)) !4398270906596 ((!4398271955163 Maybe/some !4398277198045 _6) !4398279295203 Direction/right)) !4398286635286 ((((!4398287683820 U48/if !4398295023854 _7) !4398297121022 (== !4398301315322 keycode !4398309703933 40)) !4398313898252 ((!4398314946820 Maybe/some !4398320189702 _8) !4398322286859 Direction/down)) !4398328578325 (!4398329626898 Maybe/none !4398334869780 _9))))): ∀(keycode: !4398135640152 U48) !4398141931628 (!4398142980193 Maybe !4398149271659 Direction)};
Direction/left = {!7696600268854 ~!7696601317430 λP !7696605511734 λleft !7696612851766 λup !7696618094646 λright !7696626483254 λdown !7696633823286 left: !7696588734480 Direction};
Direction/match = {λP λleft λup λright λdown λdirection !32985529188557 (((((!32985530237112 ~!32985531285687 direction !32985541771449 P) !32985543868606 left) !32985549111489 up) !32985552257223 right) !32985558548684 down): ∀(P: !32985372950554 ∀(x: !32985360367636 Direction) !32985373999129 *) ∀(left: !32985384484916 (!32985385533476 P !32985387630643 Direction/left)) ∀(up: !32985410699339 (!32985411747901 P !32985413845066 Direction/up)) ∀(right: !32985437962344 (!32985439010903 P !32985441108071 Direction/right)) ∀(down: !32985467322499 (!32985468371059 P !32985470468226 Direction/down)) ∀(direction: !32985500876954 Direction) !32985513459882 (!32985514508447 P !32985516605609 direction)};
Direction/right = {!8796112945208 ~!8796113993784 λP !8796118188088 λleft !8796125528120 λup !8796130771000 λright !8796139159608 λdown !8796146499640 right: !8796101410833 Direction};
Direction/up = {!9895621427250 ~!9895622475826 λP !9895626670130 λleft !9895634010162 λup !9895639253042 λright !9895647641650 λdown !9895654981682 up: !9895609892878 Direction};
GameState = {$(self: GameState) ∀(P: ∀(x: GameState) *) ∀(inProgress: ∀(currentPlayer: !16492720554034 Player) ∀(cursorPosition: !16492746768467 ((!16492747817034 Pair !16492753059918 U48) !16492757254226 U48)) ∀(board: !16492771934312 (!16492772982882 List !16492778225767 Move)) (P (((GameState/inProgress currentPlayer) cursorPosition) board))) ∀(draw: ∀(board: !16492801294468 (!16492802343038 List !16492807585923 Move)) (P (GameState/draw board))) ∀(winner: ∀(player: !16492833800350 Player) ∀(board: !16492850577587 (!16492851626157 List !16492856869042 Move)) (P ((GameState/winner player) board))) (P self): *};
GameState/draw = {λboard !17592226938965 ~!17592227987541 λP !17592232181845 λinProgress !17592245813333 λdraw !17592253153365 λwinner !17592262590549 (!17592263639118 draw !17592268882004 board): ∀(board: !17592200724505 (!17592201773075 List !17592207015960 Move)) !17592215404581 GameState};
GameState/inProgress = {λcurrentPlayer λcursorPosition λboard !15393269743799 ~!15393270792375 λP !15393274986679 λinProgress !15393288618167 λdraw !15393295958199 λwinner !15393305395383 (((!15393306443923 inProgress !15393317978273 currentPlayer) !15393332658352 cursorPosition) !15393348386998 board): ∀(currentPlayer: !15393192149026 Player) ∀(cursorPosition: !15393218363459 ((!15393219412026 Pair !15393224654910 U48) !15393228849218 U48)) ∀(board: !15393243529304 (!15393244577874 List !15393249820759 Move)) !15393258209380 GameState};
GameState/match = {λP λinProgress λdraw λwinner λgameState !30786721939871 ((((!30786722988422 ~!30786724036997 gameState !30786734522759 P) !30786736619922 inProgress) !30786748154263 draw) !30786753397150 winner): ∀(P: !30786349695002 ∀(x: !30786337112084 GameState) !30786350743577 *) ∀(inProgress: !30786367520957 ∀(currentPlayer: !30786387443777 Player) !30786395832509 ∀(cursorPosition: !30786416803941 ((!30786417852508 Pair !30786423095392 U48) !30786427289700 U48)) !30786433581245 ∀(board: !30786445115517 (!30786446164087 List !30786451406972 Move)) !30786458747068 (!30786459795585 P !30786461892795 (((!30786462941335 GameState/inProgress !30786484961445 currentPlayer) !30786499641524 cursorPosition) !30786515370170 board))) ∀(draw: !30786532147448 ∀(board: !30786543681755 (!30786544730325 List !30786549973210 Move)) !30786557313271 (!30786558361823 P !30786560458998 (!30786561507567 GameState/draw !30786577236213 board))) ∀(winner: !30786596110674 ∀(player: !30786608693524 Player) !30786617082194 ∀(board: !30786628616492 (!30786629665062 List !30786634907947 Move)) !30786642248017 (!30786643296560 P !30786645393744 ((!30786646442306 GameState/winner !30786664268105 player) !30786671608143 board))) ∀(gameState: !30786693628264 GameState) !30786706211192 (!30786707259757 P !30786709356919 gameState)};
GameState/moveCursor = {λstate λdirection !31886021755553 let a = !31886030143858 λd !31886034338160 use d.P = _10; use d.left = !31886067892463 (((!31886068941032 Pair/mapFst !31886081523946 _11) !31886083621100 _12) !31886085718254 _13); use d.up = !31886109835543 (((!31886110884112 Pair/mapSnd !31886123467026 _14) !31886125564180 _15) !31886127661334 _16); use d.right = !31886154924354 (((!31886155972923 Pair/mapFst !31886168555837 _17) !31886170652991 _18) !31886172750145 _19); use d.down = !31886198964588 (((!31886200013157 Pair/mapSnd !31886212596071 _20) !31886214693225 _21) !31886216790379 _22); ((((((Direction/match d.P) d.left) d.up) d.right) d.down) d); !31886225179297 let b = !31886233567732 λd !31886237762034 use d.P = _23; use d.left = !31886267122082 backward; use d.up = !31886293336507 backward; use d.right = !31886322696662 forward; use d.down = !31886349959664 forward; ((((((Direction/match d.P) d.left) d.up) d.right) d.down) d); !31886361494177 use state.P = _24; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !31886395048580 let position = !31886410777159 (((!31886411825701 a !31886413922863 direction) !31886424408644 state.cursorPosition) !31886446428742 b); !31886453768833 (((!31886454817367 GameState/inProgress !31886466351723 state.currentPlayer) !31886487323252 position) !31886496760448 state.board); use state.draw = λstate.board !31886518780559 state; use state.winner = λstate.player λstate.board !31886535557791 state; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state): ∀(state: !31885973520523 GameState) ∀(direction: !31885997637794 Direction) !31886010220718 GameState};
GameState/winner = {λplayer λboard !29686874767473 ~!29686875816049 λP !29686880010353 λinProgress !29686893641841 λdraw !29686900981873 λwinner !29686910419057 ((!29686911467619 winner !29686918807658 player) !29686926147696 board): ∀(player: !29686831775767 Player) ∀(board: !29686848553004 (!29686849601574 List !29686854844459 Move)) !29686863233080 GameState};
List = {λT $(self: (List T)) ∀(P: ∀(x: (List T)) *) ∀(cons: ∀(head: !18691727032349 T) ∀(tail: !18691737518126 (!18691738566699 List !18691743809581 T)) (P (((List/cons T) head) tail))) ∀(nil: (P (List/nil T))) (P self): ∀(T: _25) *};
List/cons = {λT λhead λtail !19791259631699 ~!19791260680275 λP !19791264874579 λcons !19791272214611 λnil !19791278506066 ((!19791279554631 cons !19791284797516 head) !19791290040401 tail): ∀(T: _26) ∀(head: !19791227125778 T) ∀(tail: !19791237611555 (!19791238660128 List !19791243903010 T)) !19791249145902 (!19791250194475 List !19791255437357 T)};
List/nil = {λT !20890741899306 ~!20890742947882 λP !20890747142186 λcons !20890754482218 λnil !20890760773673 nil: ∀(T: _27) !20890731413522 (!20890732462095 List !20890737704977 T)};
Maybe = {λT $(self: (Maybe T)) ∀(P: ∀(x: (Maybe T)) *) ∀(some: ∀(value: !10995150880802 T) (P ((Maybe/some T) value))) ∀(none: (P (Maybe/none T))) (P self): ∀(T: !10995132006416 *) *};
Maybe/match = {λA λP λs λn λma !37383525367943 (((!37383526416513 ~!37383527465088 ma !37383530610818 P) !37383532707972 s) !37383534805126 n): ∀(A: _28) ∀(P: !37383423655966 ∀(x: !37383411073048 (!37383412121621 Maybe !37383418413079 A)) !37383424704541 *) ∀(s: !37383432044618 ∀(value: !37383443578927 A) !37383446724681 (!37383447773235 P !37383449870408 ((!37383450918975 Maybe/some !37383462453313 A) !37383464550471 value))) ∀(n: !37383478181985 (!37383479230545 P !37383481327712 (!37383482376285 Maybe/none !37383493910623 A))) ∀(ma: !37383504396401 (!37383505444974 Maybe !37383511736432 A)) !37383516979322 (!37383518027894 P !37383520125049 ma)};
Maybe/none = {λT !12094650974254 ~!12094652022830 λP !12094656217134 λsome !12094663557166 λnone !12094670897197 none: ∀(T: _29) !12094639439892 (!12094640488465 Maybe !12094646779923 T)};
Maybe/some = {λT λvalue !13194174136385 ~!13194175184961 λP !13194179379265 λsome !13194186719297 λnone !13194194059328 (!13194195107897 some !13194200350783 value): ∀(T: _30) ∀(value: !13194158407699 T) !13194162602015 (!13194163650588 Maybe !13194169942046 T)};
Move = {$(self: Move) ∀(P: ∀(x: Move) *) ∀(new: ∀(player: !21990258769951 Player) ∀(cell: !21990274498614 ((!21990275547181 Pair !21990280790065 U48) !21990284984373 U48)) (P ((Move/new player) cell))) (P self): *};
Move/new = {λplayer λcell !23089798709328 ~!23089799757904 λP !23089803952208 λnew !23089810243664 ((!23089811292227 new !23089815486538 player) !23089822826575 cell): ∀(player: !23089758863380 Player) ∀(cell: !23089774592043 ((!23089775640610 Pair !23089780883494 U48) !23089785077802 U48)) !23089792417842 Move};
Nat = {$(self: Nat) ∀(P: ∀(x: Nat) *) ∀(succ: ∀(pred: !42880977600538 Nat) (P (Nat/succ pred))) ∀(zero: (P Nat/zero)) (P self): *};
Nat/succ = {λn !43980487131185 ~!43980488179761 λP !43980492374065 λsucc !43980499714097 λzero !43980507054128 (!43980508102701 succ !43980513345583 n): ∀(n: !43980475596813 Nat) !43980481888275 Nat};
Nat/zero = {!45079989321764 ~!45079990370340 λP !45079994564644 λsucc !45080001904676 λzero !45080009244707 zero: !45079984078858 Nat};
Pair = {λA λB $(self: ((Pair A) B)) ∀(P: ∀(x: ((Pair A) B)) *) ∀(new: ∀(fst: !24189293559845 A) ∀(snd: !24189302997038 B) (P ((((Pair/new A) B) fst) snd))) (P self): ∀(A: !24189270491151 *) ∀(B: !24189277831190 *) *};
Pair/mapFst = {λA λB λT λp λf !34084940152952 use p.P = _31; use p.new = λp.fst λp.snd !34084957978742 ((((!34084959027297 Pair/new !34084963221603 T) !34084965318757 B) !34084967415919 (!34084968464488 f !34084970561646 p.fst)) !34084977901685 p.snd); (((((Pair/match _32) _33) p.P) p.new) p): ∀(A: _34) ∀(B: _35) ∀(T: _36) ∀(p: !34084902404146 ((!34084903452717 Pair !34084908695599 A) !34084910792753 B)) ∀(f: !34084923375679 ∀(x: !34084919181369 A) !34084924424254 T) !34084928618571 ((!34084929667142 Pair !34084934910024 T) !34084937007178 B)};
Pair/mapSnd = {λA λB λT λp λf !36283964457081 use p.P = _37; use p.new = λp.fst λp.snd !36283982282871 ((((!36283983331426 Pair/new !36283987525732 A) !36283989622886 T) !36283991720044 p.fst) !36283998011510 (!36283999060079 f !36284001157237 p.snd)); (((((Pair/match _38) _39) p.P) p.new) p): ∀(A: _40) ∀(B: _41) ∀(T: _42) ∀(p: !36283925659698 ((!36283926708269 Pair !36283931951151 A) !36283934048305 B)) ∀(f: !36283946631231 ∀(x: !36283942436921 B) !36283947679806 T) !36283951874123 ((!36283952922694 Pair !36283958165576 A) !36283960262730 T)};
Pair/match = {λA λB λP λnew λpair !35184502112393 ((!35184503160963 ~!35184504209538 pair !35184509452420 P) !35184511549576 new): ∀(A: _43) ∀(B: _44) ∀(P: !35184405643299 ∀(x: !35184392011805 ((!35184393060376 Pair !35184398303258 A) !35184400400412 B)) !35184406691874 *) ∀(new: !35184416129117 ∀(fst: !35184425566260 A) !35184428712029 ∀(snd: !35184438149184 B) !35184441294940 (!35184442343492 P !35184444440667 ((((!35184445489230 Pair/new !35184454926416 A) !35184457023570 B) !35184459120726 fst) !35184463315034 snd))) ∀(pair: !35184477995119 ((!35184479043690 Pair !35184484286572 A) !35184486383726 B)) !35184491626618 (!35184492675188 P !35184494772345 pair)};
Pair/new = {λA λB λa λb !25288809381949 ~!25288810430525 λP !25288814624829 λnew !25288820916284 ((!25288821964855 new !25288826159161 a) !25288828256315 b): ∀(A: _45) ∀(B: _46) ∀(a: !25288785264658 A) ∀(b: !25288792604697 B) !25288796799014 ((!25288797847585 Pair !25288803090467 A) !25288805187621 B)};
Player = {$(self: Player) ∀(P: ∀(x: Player) *) ∀(x: (P Player/x)) ∀(o: (P Player/o)) (P self): *};
Player/o = {!27487803277338 ~!27487804325914 λP !27487808520218 λx !27487812714522 λo !27487816908826 o: !27487794888714 Player};
Player/x = {!28587314905114 ~!28587315953690 λP !28587320147994 λx !28587324342298 λo !28587328536602 x: !28587306516490 Player};
String = {!38482922700826 (!38482923749396 List !38482928992281 Char): !38482916409354 *};
String/cons = {λhead λtail !40681982656597 ~!40681983705173 λP !40681987899477 λcons !40681995239509 λnil !40682001530964 ((!40682002579529 cons !40682007822414 head) !40682013065299 tail): ∀(head: !40681951199256 Char) ∀(tail: !40681964830759 String) !40681974267952 String};
String/nil = {!41781463875627 ~!41781464924203 λP !41781469118507 λcons !41781476458539 λnil !41781482749994 nil: !41781455486995 String};
U48/if = {λP λx λt λf !14294062203302 switch x = x { 0: !14294078980505 f _: use x-1 = x-1; !14294086320544 t }: !14294091563429 P: ∀(P: _47) ∀(x: !14294038086004 U48) ∀(t: !14294047523195 P) ∀(f: !14294054863234 P) !14294059057542 P};
backward = {λn !31885943111788 (- !31885946257513 1 !31885948354667 n): ∀(n: !31885929480283 U48) !31885936820322 U48};
forward = {λn !31885907460170 (+ !31885910605895 1 !31885912703049 n): ∀(n: !31885893828665 U48) !31885901168704 U48};
main = {!1099521065621 use init = !1099534696760 (((!1099535745067 GameState/inProgress !1099558813749 Player/x) !1099569299529 ((((!1099570348096 Pair/new !1099579785282 _48) !1099581882436 _49) !1099583979590 0) !1099586076744 0)) !1099590271287 (((List/cons _50) !1099591319666 ((!1099592368213 Move/new !1099601805406 Player/x) !1099611242609 ((((!1099612291176 Pair/new !1099621728362 _51) !1099623825516 _52) !1099625922670 0) !1099628019824 0))) (((List/cons _53) !1099642699939 ((!1099643748486 Move/new !1099653185679 Player/x) !1099662622882 ((((!1099663671449 Pair/new !1099673108635 _54) !1099675205789 _55) !1099677302943 1) !1099679400097 1))) (((List/cons _56) !1099694080212 ((!1099695128759 Move/new !1099704565952 Player/x) !1099714003155 ((((!1099715051722 Pair/new !1099724488908 _57) !1099726586062 _58) !1099728683216 2) !1099730780370 2))) (((List/cons _59) !1099745460485 ((!1099746509032 Move/new !1099755946225 Player/o) !1099765383428 ((((!1099766431995 Pair/new !1099775869181 _60) !1099777966335 _61) !1099780063489 0) !1099782160643 1))) (((List/cons _62) !1099796840758 ((!1099797889305 Move/new !1099807326498 Player/o) !1099816763701 ((((!1099817812268 Pair/new !1099827249454 _63) !1099829346608 _64) !1099831443762 2) !1099833540916 0))) (List/nil _65))))))); !1099840881301 use tick = !1099852415318 λstate !1099862901076 state; !1099870241429 use when = !1099881775738 λkey !1099888067194 λstate !1099898552952 use state.P = _66; use state.inProgress = λstate.currentPlayer λstate.cursorPosition λstate.board !1099946787395 let direction = !1099963564490 (!1099964613061 Direction/fromKeycode !1099987681737 key); !1099999216190 use direction.P = _67; use direction.some = λdirection.value !1100039062051 ((!1100040110604 GameState/moveCursor !1100062130706 state) !1100068422178 direction.value); use direction.none = !1100099879478 state; (((((Maybe/match _68) direction.P) direction.some) direction.none) direction); use state.draw = λstate.board !1100135531096 state; use state.winner = λstate.player λstate.board !1100164891252 state; (((((GameState/match state.P) state.inProgress) state.draw) state.winner) state); !1100176425620 ((((!1100177474178 App/new !1100185862788 _69) !1100187959945 init) !1100193202830 tick) !1100198445715 when): !1099517919239 _70};
MAIN = main;
